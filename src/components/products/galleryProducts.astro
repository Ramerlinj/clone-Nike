---
import productsData from '../../data/products.json';
import ProductsHeader from './ProductsHeader.astro';

// Mostramos los primeros 8 productos inicialmente
const initialProducts = productsData.slice(0, 8);
const remainingProducts = productsData.slice(8);
const hasMoreProducts = remainingProducts.length > 0;
---

<section class="w-full px-4 md:px-12 py-16 mt-22">
    <div class="max-w-6xl mx-auto">
        <!-- Header de la sección -->
        <ProductsHeader totalProducts={productsData.length} />

        <!-- Grid de productos iniciales -->
        <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            {initialProducts.map((product) => (
                <div class="bg-gray-100 rounded-lg overflow-hidden hover:shadow-lg transition-shadow duration-300">
                    
                    <div class="aspect-square bg-gray-200 relative overflow-hidden">
                        <img 
                            src={product.image} 
                            alt={product.name}
                            class="w-full h-full object-cover"
                        />
                        
                        <!-- Badge de descuento -->
                        {product.discount && (
                            <div class="absolute top-3 right-3 bg-red-500 text-white px-2 py-1 rounded text-xs font-bold">
                                {product.discount} off
                            </div>
                        )}
                    </div>
                    
                    <!-- Información del producto -->
                    <div class="p-4 bg-white">
                        <h3 class="font-nike-bold text-gray-900 mb-2">{product.name}</h3>
                        <p class="text-gray-600 text-sm mb-3">{product.description}</p>
                        
                        <!-- Precio -->
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2">
                                <span class="font-nike-bold text-gray-900 text-lg">{product.price}</span>
                                {product.originalPrice && (
                                    <span class="text-gray-500 text-sm line-through">{product.originalPrice}</span>
                                )}
                            </div>
                            
                            <!-- Botón de comprar -->
                            <button class="bg-primary text-white px-4 py-2 rounded-full text-sm font-nike-medium hover:bg-gray-800 transition-colors">
                                Buy Now
                            </button>
                        </div>
                    </div>
                </div>
            ))}
        </div>
        
        <!-- Productos adicionales (ocultos inicialmente) -->
        <div id="additional-products" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mt-6" style="display: none;">
            {remainingProducts.map((product) => (
                <div class="bg-gray-100 rounded-lg overflow-hidden hover:shadow-lg transition-shadow duration-300">
                    <!-- Imagen del producto -->
                    <div class="aspect-square bg-gray-200 relative overflow-hidden">
                        <img 
                            src={product.image} 
                            alt={product.name}
                            class="w-full h-full object-cover"
                        />
                        
                        <!-- Badge de descuento -->
                        {product.discount && (
                            <div class="absolute top-3 right-3 bg-red-500 text-white px-2 py-1 rounded text-xs font-bold">
                                {product.discount} off
                            </div>
                        )}
                    </div>
                    
                    <!-- Información del producto -->
                    <div class="p-4 bg-white">
                        <h3 class="font-nike-bold text-gray-900 mb-2">{product.name}</h3>
                        <p class="text-gray-600 text-sm mb-3">{product.description}</p>
                        
                        <!-- Precio -->
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2">
                                <span class="font-nike-bold text-gray-900 text-lg">{product.price}</span>
                                {product.originalPrice && (
                                    <span class="text-gray-500 text-sm line-through">{product.originalPrice}</span>
                                )}
                            </div>
                            
                            <!-- Botón de comprar -->
                            <button class="bg-primary text-white px-4 py-2 rounded-full text-sm font-nike-medium hover:bg-gray-800 transition-colors">
                                Buy Now
                            </button>
                        </div>
                    </div>
                </div>
            ))}
        </div>
        
        <!-- Load more button -->
        {hasMoreProducts && (
            <div class="text-center mt-12">
                <button 
                    id="load-more-btn"
                    class="bg-secondary text-primary px-8 py-3 rounded-full font-nike-medium hover:bg-opacity-90 transition-colors"
                >
                    Ver más ({remainingProducts.length})
                </button>
            </div>
        )}
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const loadMoreBtn = document.getElementById('load-more-btn');
        const additionalProducts = document.getElementById('additional-products');
        
        if (loadMoreBtn && additionalProducts) {
            loadMoreBtn.addEventListener('click', function() {
                // Mostrar productos adicionales
                additionalProducts.style.display = 'grid';
                
                // Ocultar el botón
                loadMoreBtn.parentElement?.remove();
                
                // Scroll suave hacia los nuevos productos
                additionalProducts.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'start' 
                });
            });
        }
    });
</script>